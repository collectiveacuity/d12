/*!
* @name D12
* @description A Platonic Solid for Ideal Data
* @author rcj1492
* @license MIT
* @version 0.0.7
* @copyright 2018-2019 Collective Acuity 
* @email support@collectiveacuity.com
* @url https://github.com/collectiveacuity/d12
*/
"use strict";"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isString=isString;exports.isNumber=isNumber;exports.isBoolean=isBoolean;exports.isPlainObject=isPlainObject;exports.isArray=isArray;exports.isInteger=isInteger;exports.isObjectLike=isObjectLike;exports.isDate=isDate;exports.isFunction=isFunction;exports.ingestObject=ingestObject;exports.ingestString=ingestString;exports.ingestBoolean=ingestBoolean;exports.ingestArray=ingestArray;exports.ingestInteger=ingestInteger;exports.ingestNumber=ingestNumber;exports.ingestMap=ingestMap;exports.objectSize=objectSize;exports.ingestOptions=ingestOptions;exports.deepCopy=deepCopy;exports.emptyObject=emptyObject;exports.joinWords=joinWords;exports.parseDiff=parseDiff;exports.upsertValues=upsertValues;exports.validateString=validateString;exports.validateData=validateData;var _isString2=_interopRequireDefault(require("lodash/isString"));var _isNumber2=_interopRequireDefault(require("lodash/isNumber"));var _isBoolean2=_interopRequireDefault(require("lodash/isBoolean"));var _isPlainObject2=_interopRequireDefault(require("lodash/isPlainObject"));var _isArray2=_interopRequireDefault(require("lodash/isArray"));var _isInteger2=_interopRequireDefault(require("lodash/isInteger"));var _isObjectLike2=_interopRequireDefault(require("lodash/isObjectLike"));var _isDate2=_interopRequireDefault(require("lodash/isDate"));var _isFunction2=_interopRequireDefault(require("lodash/isFunction"));var _get2=_interopRequireDefault(require("lodash/get"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function e(t){return typeof t}}else{_typeof=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return _typeof(e)}function isString(e){return(0,_isString2.default)(e)}function isNumber(e){return(0,_isNumber2.default)(e)}function isBoolean(e){return(0,_isBoolean2.default)(e)}function isPlainObject(e){return(0,_isPlainObject2.default)(e)}function isArray(e){return(0,_isArray2.default)(e)}function isInteger(e){return(0,_isInteger2.default)(e)}function isObjectLike(e){return(0,_isObjectLike2.default)(e)}function isDate(e){return(0,_isDate2.default)(e)}function isFunction(e){return(0,_isFunction2.default)(e)}function ingestObject(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(t){return isPlainObject((0,_get2.default)(e,t))?e:{}}else{return isPlainObject(e)?e:{}}}function ingestString(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(t){return isString((0,_get2.default)(e,t))?e:""}else{return isString(e)?e:""}}function ingestBoolean(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(t){return isBoolean((0,_get2.default)(e,t))?e:false}else{return isBoolean(e)?e:false}}function ingestArray(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(t){return isArray((0,_get2.default)(e,t))?e:[]}else{return isArray(e)?e:[]}}function ingestInteger(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(t){return isInteger((0,_get2.default)(e,t))?e:0}else{return isInteger(e)?e:0}}function ingestNumber(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(t){return isNumber((0,_get2.default)(e,t))?e:0}else{return isNumber(e)?e:0}}function ingestMap(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(t){return isPlainObject((0,_get2.default)(e,t))?e:{}}else{return isPlainObject(e)?e:{}}}function objectSize(e){return Object.keys(ingestObject(e)).length}function ingestOptions(e,t){e=ingestMap(e);function i(e,t){var r={};if(!objectSize(t)){for(var s in e){r[s]=e[s]}}else{for(var u in t){if(u in e){if(_typeof(e[u])===_typeof(t[u])){if(isArray(e[u])){r[u]=n(e[u],t[u])}else if(isPlainObject(e[u])){r[u]=i(e[u],t[u])}else{r[u]=e[u]}}else{r[u]=t[u]}}else if(isArray(t[u])){r[u]=[]}else{r[u]=t[u]}}}return r}function n(e,t){var r=[];var s=null;try{s=t[0]}catch(e){}for(var u=0;u<e.length;u++){if(s==null){r.push(e)}else{if(_typeof(e[u])===_typeof(s)){if(isArray(e[u])){r.push(n(e[u],s))}else if(isPlainObject(e[u])){r.push(i(e[u],s))}else{r.push(e[u])}}}}return r}return i(e,t)}function deepCopy(e){if(e==null||!isObjectLike(e)){return e}else{if(isDate(e)){return e}var t=e.constructor();for(var i in e){if(e.hasOwnProperty(i))t[i]=deepCopy(e[i])}return t}}function emptyObject(e){for(var t in e){if(e.hasOwnProperty(t)){e[t]=null;delete e[t]}}}function joinWords(e,t){var i={conjunction:"and",prefix:"",suffix:""};var n=ingestOptions(t,i);var r="";for(var s=0;s<e.length;s++){if(r){if(s+1===e.length){r+=" "+n.conjunction+" "}else{r+=", "}}r+=n.prefix+e[s]+n.suffix}return r}function parseDiff(e,t){function i(e,t){var n={};for(var r in e){if(r in t){if(e[r]==null&&t[r]!=null){n[r]=e[r]}else if(isPlainObject(e[r])){if(isPlainObject(t[r])){var s=i(e[r],t[r]);if(objectSize(s)){n[r]=s}}else{n[r]=e[r]}}else if(e[r]!==t[r]){n[r]=e[r]}}else{n[r]=e[r]}}for(var u in t){if(!(u in e)){n[u]=null}}return n}var n={altered:ingestObject(e),original:ingestObject(t),parsed:{}};if(objectSize(n.altered)){n.parsed=i(n.altered,n.original)}return n.parsed}function upsertValues(e,t){function i(e,t){for(var n in e){if(e[n]==null&&n in t){delete t[n]}else if(isPlainObject(e[n])){if(n in t&&isPlainObject(t[n])){t[n]=i(e[n],t[n])}else{t[n]=e[n]}}else{t[n]=e[n]}}return t}var n={upsert:deepCopy(ingestObject(e)),existing:deepCopy(ingestObject(t)),updated:{}};if(objectSize(n.upsert)){n.updated=i(n.upsert,n.existing)}return n.updated}function validateString(e,t,i){var n={order:"must_contain,equal_to,min_length,discrete_values,must_not_contain,max_length,excluded_values"};var r=ingestOptions(i,n);var s={must_contain:{},must_not_contain:{},equal_to:{},max_length:0,min_length:0,discrete_values:[""],excluded_values:[""]};var u=ingestOptions(t,s);var a={required:"",prohibited:""};function o(){for(var t in u.must_contain){var i=new RegExp(t,"i");if(!i.test(e)){return u.must_contain[t]}}}function l(){for(var t in u.equal_to){if(t!==e){return u.equal_to[t]}}}function f(){if(u.min_length){if(e.length<u.min_length){return"must contain at least "+u.min_length.toString()+" characters"}}}function c(){if(u.discrete_values.length){if(u.discrete_values.indexOf(e)===-1){var t=joinWords(u.discrete_values,{conjunction:"or",prefix:'"',suffix:'"'});return"may only be "+t}}}function d(){for(var t in u.must_not_contain){var i=new RegExp(t,"i");if(i.test(e)){return u.must_not_contain[t]}}}function p(){if(u.max_length){if(e.length>u.max_length){return"cannot contain more than "+u.max_length.toString()+" characters"}}}function g(){if(u.excluded_values.length){if(u.excluded_values.indexOf(e)>-1){var t=joinWords(u.excluded_values,{conjunction:"or",prefix:'"',suffix:'"'});return"cannot be "+t}}}var _={must_contain:o,must_not_contain:d,equal_to:l,max_length:p,min_length:f,discrete_values:c,excluded_values:g};var v={must_contain:"required",must_not_contain:"prohibited",equal_to:"required",max_length:"prohibited",min_length:"required",discrete_values:"required",excluded_values:"prohibited"};var b=r.order.split(",");var h=[];var x=[];for(var m=0;m<b.length;m++){var y=b[m];if(y in _){x.push(y);h.push(_[y])}}for(var j=0;j<h.length;j++){var O=h[j]();if(O){var q=x[j];if(v[q]==="required"){a.required=O}else if(v[q]==="prohibited"){a.prohibited=O}return a}}return a}function validateData(e,t,i){var n={order:"must_contain,equal_to,min_length,discrete_values,must_not_contain,max_length,excluded_values"};var r=ingestOptions(i,n);var s={required:"",prohibited:""};var u=ingestString(t.datatype);if(u==="string"){if(isString(e)){return validateString(e,t,r)}else{s.required="must be a string datatype.";return s}}return s}